---
title: 资源绑定概述
description: DirectX 12 中的资源绑定到的密钥描述符、 描述符表、 描述符的概念是堆的方法和根签名。
ms.assetid: 92E100CA-822D-46B1-BD37-FF57C3FB703D
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b42abacbceb0562bc6fdac31e0837a82e092db12
ms.sourcegitcommit: 1fbe7572f20938331e9c9bd6cccd098fa1c6054d
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/27/2019
ms.locfileid: "66224188"
---
# <a name="resource-binding-overview"></a>资源绑定概述

DirectX 12 中的资源绑定的关键是两个的概念*描述符*，*描述符表*，*描述符堆*，和一个*根签名*.

-   [资源和图形管道](#resources-and-the-graphics-pipeline)
-   [资源类型和视图](#resource-types-and-views)
-   [资源绑定控制流](#resource-binding-overview)
-   [子分配](#suballocation)
-   [释放资源](#freeing-resources)
-   [相关的主题](#related-topics)

## <a name="resources-and-the-graphics-pipeline"></a>资源和图形管道

着色器资源 （例如纹理、 常量表、 图像、 缓冲区等） 不直接绑定到着色器管道中;相反，通过引用*描述符*。 描述符是包含一个资源的相关信息的小型对象。

描述符组合在一起形成*描述符表*。 每个描述符表存储一个范围的资源类型的信息。 有许多不同类型的资源。 最常见的资源包括：

-   常量缓冲区视图 (CBVs)
-   无序的访问视图 (Uav)
-   着色器资源视图 (SRVs)
-   取样器

SRV、 UAV 和 CBVs 描述符可以合并为同一个描述符表。

图形和计算管道通过按索引引用到描述符表获得对资源的访问。

描述符表存储在*描述符堆*。 描述符堆将理想情况下包含 （在描述符表） 的所有描述符的一个或多个要呈现的帧。 所有资源将都存储在用户模式下堆。

另一个概念是*根签名*。 根签名是由着色器用来定位他们需要访问的资源的应用程序定义的绑定约定。 根签名可以存储：

-   描述符堆，其中已预定义的描述符表布局中的描述符表编制索引。
-   常量，因此应用程序可以绑定用户定义的常量 (称为*根常量*) 直接向着色器而无需通过描述符和描述符表。
-   极少数的直接在根签名，如更改每个绘图，从而节约了应用程序无需将这些描述符放描述符堆中的常量缓冲区视图 (CBV) 的描述符。

换而言之，根签名提供性能优化，适用于少量的更改每个绘图的数据。

Direct3D 12 中设计的绑定将它隔离与其他任务，例如内存管理、 对象生存期管理、 状态跟踪和内存同步 (请参阅[差异绑定模型中的从 Direct3D 11](binding-model.md))。 Direct3D 12 绑定是设计为较低的开销，针对最常进行的 API 调用进行了优化。 它也是可缩放跨低结束到高端硬件，且可缩放从较旧 （更具线性 Direct3D 11 管道） 到 （更并行） 的较新图形引擎编程方法。

## <a name="resource-types-and-views"></a>资源类型和视图

资源类型即是 Direct3D 11 相同：

-   Texture1D 和 Texture1DArray
-   Texture2D 和 Texture2DArray，Texture2DMS，Texture2DMSArray
-   Texture3D
-   缓冲区 （类型化、 结构化和原始）

资源视图是类似但略有不同于 Direct3D 11，已添加顶点和索引缓冲区视图。

-   常量缓冲区视图 (CBV)
-   无序的访问视图 (UAV)
-   着色器资源视图 (SRV)
-   取样器
-   呈现目标视图 (RTV)
-   深度模具视图 (DSV)
-   索引缓冲区视图 (IBV)
-   顶点缓冲区视图 (VBV)
-   Stream 输出视图 (SOV)

只有这些视图的前四个到着色器实际可见，请参阅[着色器可见描述符堆](shader-visible-descriptor-heaps.md)并[非着色器可见描述符堆](non-shader-visible-descriptor-heaps.md)。

## <a name="resource-binding-flow-of-control"></a>资源绑定控制流

专注于只根签名、 根描述符、 根常量、 描述符表和描述符堆，应用的呈现逻辑的流应类似于下面：

-   创建一个或多个根签名对象 – 一个用于应用程序需要每个不同的绑定配置。
-   创建着色器和管道使用它们将与一起使用的根签名对象的状态。
-   创建一个 (或如有必要，更多) 描述符堆将包含所有 SRV、 UAV 和 CBV 描述符的呈现的每个帧。
-   在可能的情况将在多个帧中重复使用的描述符集初始化描述符堆。
-   要在呈现每个帧：
    -   为每个命令列表：
        -   设置当前的根签名，以使用 （并根据需要 – 这是一般不要求在呈现期间更改）。
        -   更新某些根签名的常量和/或新视图 （如 world/视图投影） 的根签名描述符。
        -   若要绘制每个项：
            -   堆根据需要为每个对象呈现描述符中定义任何新的描述符。 着色器可见描述符堆，应用程序必须确保使用描述符堆空间不是已被引用呈现可能正在进行中 – 例如，以线性方式分配通过描述符堆空间在呈现过程。
            -   堆更新指向描述符的所需区域根签名。 例如，一个描述符表可能指向初始化更早版本，而另一个描述符表可能指向为当前呈现配置一些动态描述符一些静态 （不更改） 的描述符。
            -   更新某些根签名的常量和/或每个项呈现的根签名描述符。
            -   管道状态绘制 （仅当需要进行更改），请将该项设置与当前绑定的根签名兼容。
            -   Draw
        -   重复 （下一项）
    -   重复 （下一步命令列表）
    -   严格 GPU 结束时将不再使用的任何内存，具有可释放。 不需要对它的描述符的引用要删除，如果使用这些描述符的附加呈现不提交。 因此，后续呈现都可以堆、 指向描述符中的其他区域或过时的描述符可以覆盖具有有效的描述符重用描述符堆空间。
-   重复 （下一帧）

请注意，其他描述符类型，呈现目标视图 (RTVs)、 深度模具视图 (DSV)、 索引缓冲区视图 (IBVs)、 顶点缓冲区视图 (VBVs) 和着色器对象视图 (SOV) 的管理方式。 该驱动程序处理的命令列表 （类似于如何根签名绑定是由硬件/驱动程序版本控制） 的录制期间绑定的每个绘图的描述符集的版本控制。 这是不同的着色器可见描述符内容堆、 为其应用程序必须手动分配堆通过它引用之间绘制不同的描述符。 因为它允许应用程序执行某些操作，如重用描述符不更改，或使用大型的静态描述符集并使用索引的着色器的着色器可见的堆内容的版本控制为从左到应用程序 (如按材料 ID) 来选择若要使用从描述符堆，或者使用技术的组合以不同的描述符的描述符。 硬件不具备处理这种类型的其他描述符类型 （RTV、 数据源视图、 IBV、 VBV、 SOV） 的灵活性。

## <a name="suballocation"></a>子分配

在 Direct3D 12 中，应用程序具有对内存管理低级别控制。 在早期版本的 Direct3D，包括 Direct3D 11 中，将有一个分配每个资源。 在 Direct3D 12 中，应用程序可以使用 API 来分配内存，不是任何单个对象需要更大的大块。 此操作完成后，该应用可以创建描述符，使其指向该较大内存块的部分。 决定要放置的位置的内容的此过程 （在较大的块中的较小的块） 被称为*子分配*。 使应用程序来执行此操作可以产生高效使用计算和内存中的提升。 例如，资源重命名为呈现已过时。 应用可以使用界定来确定何时使用特定的资源和当它不是由隔离上命令列表执行命令列表，需要使用该特定资源。

## <a name="freeing-resources"></a>释放资源

可以释放任何绑定到管道的内存之前，必须与其已完成 GPU。

等待帧呈现可能是为了确定 GPU 已完成的粗糙方法。 在更精细的粒度，可以再次使用界定 — 当命令记录到你想要跟踪的完成的命令列表中，紧跟在其后插入起一道围墙。 然后，可以执行 fence 各种同步的操作。 提交新等待，直到指定的隔离已通过指示在 GPU 上的所有内容之前完成的工作 （命令列表），也可以请求在 fence 经过 （该应用程序可以与休眠 threa 等待引发的 CPU 事件d) 中。 在 Direct3D 11 中，这是`EnqueueSetEvent`（)。

## <a name="related-topics"></a>相关主题

<dl> <dt>

[资源绑定](resource-binding.md)
</dt> </dl>

 

 




